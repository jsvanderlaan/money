<div class="bg-white shadow rounded p-4 mb-4">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-3 items-start">
        <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700">Name</label>
            <input
                [formControl]="nameControl"
                type="text"
                maxlength="50"
                class="mt-1 block w-full px-3 py-2 border border-gray-200 rounded-md placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-transparent"
                placeholder="Label name"
            />
            @if (nameControl.invalid && nameControl.touched) {
                <div class="text-xs text-red-600">Name is required (max 50 chars).</div>
            }
        </div>

        <div>
            <label class="block text-sm font-medium text-gray-700">Color</label>
            <input [formControl]="colorControl" type="color" class="mt-1 w-16 h-10 p-0 border-0" />
        </div>
    </div>

    <div class="mt-4">
        <h3 class="text-sm font-medium">Rules</h3>
        <p class="text-xs text-gray-500">
            Build a boolean expression that determines when the label applies. You can nest groups and add unlimited rules.
        </p>

        <div class="mt-3">
            @if (rootRule(); as root) {
                <app-rule [node]="root" (nodeChange)="rootRule.set($event)" (remove)="rootRule.set(null)" />
            } @else {
                <app-add-rule-buttons (add)="onRootAdd($event)" [showRemove]="false"></app-add-rule-buttons>
            }

            <div class="mt-4 flex gap-2">
                <button type="button" class="px-4 py-2 bg-green-600 text-white rounded" (click)="saveNewLabel()">
                    Save label
                </button>
                <button type="button" class="px-4 py-2 bg-gray-100 rounded" (click)="cancelCreate()">Cancel</button>
            </div>
        </div>
    </div>
</div>
